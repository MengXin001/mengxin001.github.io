import{_ as E}from"./ValaxyMain.vue_vue_type_script_setup_true_lang-bBclPI7H.js";import{_ as y,l as i,q as F,o as d,b as C,w as n,g as s,e as l,h as r,s as a,A as u}from"./app-xtvO_iNw.js";const e=JSON.parse('{"title":"处理中国地区BUFR探空数据","description":"安利 Upperair_bufr Lib --- 快速上手处理BUFR气象探空数据","frontmatter":{"title":"处理中国地区BUFR探空数据","author":"萌新","avatar":"https://document-1254197101.cos.ap-guangzhou.myqcloud.com/hexo/pic/Head.jpg","authorLink":"/","authorAbout":null,"authorDesc":null,"categories":"Hexo","date":"2022-02-02T11:00:00.000Z","comments":true,"toc":true,"tags":["Hexo"],"description":"安利 Upperair_bufr Lib --- 快速上手处理BUFR气象探空数据","cover":"https://document-1254197101.cos.ap-guangzhou.myqcloud.com/hexo/pic/SKEWT_20220202000000_45004.png"},"headers":[{"level":3,"title":"# 前情提要","slug":"前情提要","link":"#前情提要","children":[]}],"relativePath":"pages/posts/tackle-bufr.md","path":"C:/Users/Lenovo/Desktop/mengxin001.github.io/demo/pages/posts/tackle-bufr.md","lastUpdated":1706450988000}'),m={name:"pages/posts/tackle-bufr.md",data(){return{data:e,frontmatter:e.frontmatter,$frontmatter:e.frontmatter}},setup(){const o=i();o.meta.frontmatter=Object.assign(o.meta.frontmatter||{},e.frontmatter||{}),F("pageData",e)}},f={id:"前情提要",tabindex:"-1"},_=s("p",null,[l("由于种种不明因素"),s("sup",null,"???"),l("，官方渠道的探空数据进一步收紧。Wyoming极为便利的查询网站对于中国境内数据也多数缺少高空部分的数据，少部分渠道数据且用且珍惜。"),s("img",{src:"https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/valine/aru/aru-17.gif",alt:""}),l(" CMA每天需要向各国共享基本站点的00/12Z探空数据，其中共享的数据格式为BUFR(数据质量很不错)。先前在Github搜寻一圈使用过ecmwf/eccodes（ECMWF's GRIB and BUFR encoding/decoding library）进行处理，但对于进行探空可视化所需的读取过于繁杂。")],-1),D=s("p",null,[l("前几天Pyy老师开源了"),s("strong",null,"CyanideCN/TaxolLib"),l("包含许多的Libs，其中的 "),s("code",null,"upperair_bufr.py"),l(" 使用pybufrkit进行读取，已经预先处理好了各类要素的编号，大大减轻了处理负担。")],-1),B=s("p",null,[l("稍做处理返回要素数据，配套"),s("code",null,"metpy"),l("库可以计算各类指数。")],-1),A=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"	"),s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"get_data"),s("span",{style:{color:"#E1E4E8"}},"(self, station_id):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"			df "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".query(station_id)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"			pres "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," df["),s("span",{style:{color:"#9ECBFF"}},"'pressure'"),s("span",{style:{color:"#E1E4E8"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"			temp "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," df["),s("span",{style:{color:"#9ECBFF"}},"'temperature'"),s("span",{style:{color:"#E1E4E8"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"			dwpt "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," df["),s("span",{style:{color:"#9ECBFF"}},"'dewpoint'"),s("span",{style:{color:"#E1E4E8"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"			wdir "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," df["),s("span",{style:{color:"#9ECBFF"}},"'wind_direction'"),s("span",{style:{color:"#E1E4E8"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"			wspd "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," df["),s("span",{style:{color:"#9ECBFF"}},"'wind_speed'"),s("span",{style:{color:"#E1E4E8"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"			alt "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," df["),s("span",{style:{color:"#9ECBFF"}},"'geopotential'"),s("span",{style:{color:"#E1E4E8"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"			"),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," pres, temp, dwpt, wdir, wspd, alt")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"	"),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"get_data"),s("span",{style:{color:"#24292E"}},"(self, station_id):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"			df "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".query(station_id)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"			pres "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," df["),s("span",{style:{color:"#032F62"}},"'pressure'"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"			temp "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," df["),s("span",{style:{color:"#032F62"}},"'temperature'"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"			dwpt "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," df["),s("span",{style:{color:"#032F62"}},"'dewpoint'"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"			wdir "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," df["),s("span",{style:{color:"#032F62"}},"'wind_direction'"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"			wspd "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," df["),s("span",{style:{color:"#032F62"}},"'wind_speed'"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"			alt "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," df["),s("span",{style:{color:"#032F62"}},"'geopotential'"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"			"),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," pres, temp, dwpt, wdir, wspd, alt")])])]),s("button",{class:"collapse"})],-1),g=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"Sounding "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," SoundingDecoder("),s("span",{style:{color:"#9ECBFF"}},"'C:/Users/Administrator/Desktop/Sat/SatData/Upper_air/A_IUKN09BABJ300000_C_RJTD_20220130013517_60.bufr'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"data "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," Sounding.query("),s("span",{style:{color:"#9ECBFF"}},'"52836"'),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"pres, temp, dwpt, wdir, wspd, alt "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," Sounding.get_data("),s("span",{style:{color:"#9ECBFF"}},'"52836"'),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#79B8FF"}},"print"),s("span",{style:{color:"#E1E4E8"}},"(alt)")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"Sounding "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," SoundingDecoder("),s("span",{style:{color:"#032F62"}},"'C:/Users/Administrator/Desktop/Sat/SatData/Upper_air/A_IUKN09BABJ300000_C_RJTD_20220130013517_60.bufr'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"data "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," Sounding.query("),s("span",{style:{color:"#032F62"}},'"52836"'),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"pres, temp, dwpt, wdir, wspd, alt "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," Sounding.get_data("),s("span",{style:{color:"#032F62"}},'"52836"'),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#005CC5"}},"print"),s("span",{style:{color:"#24292E"}},"(alt)")])])]),s("button",{class:"collapse"})],-1),h=s("p",null,[l("同时也可以使用"),s("code",null,"to_sharppy"),l("直接生成SHARPPy格式的探空数据，丢入SHARPPy绘制分析。")],-1),b=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"import"),s("span",{style:{color:"#E1E4E8"}}," datetime")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"date "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},'"2022013001351"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"dtime "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," datetime.datetime.strptime(date, "),s("span",{style:{color:"#9ECBFF"}},"'%Y%m"),s("span",{style:{color:"#79B8FF"}},"%d"),s("span",{style:{color:"#9ECBFF"}},"%H%M%S'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"outdir "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'C:/Users/Administrator/Desktop/Sat/SatData/Upper_air'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"Sounding "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," SoundingDecoder("),s("span",{style:{color:"#9ECBFF"}},"'C:/Users/Administrator/Desktop/Sat/SatData/Upper_air/A_IUKN09BABJ300000_C_RJTD_20220130013517_60.bufr'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"out "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," Sounding.to_sharppy("),s("span",{style:{color:"#9ECBFF"}},'"52836"'),s("span",{style:{color:"#E1E4E8"}},", dtime, outdir)")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," datetime")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"date "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},'"2022013001351"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"dtime "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," datetime.datetime.strptime(date, "),s("span",{style:{color:"#032F62"}},"'%Y%m"),s("span",{style:{color:"#005CC5"}},"%d"),s("span",{style:{color:"#032F62"}},"%H%M%S'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"outdir "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'C:/Users/Administrator/Desktop/Sat/SatData/Upper_air'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"Sounding "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," SoundingDecoder("),s("span",{style:{color:"#032F62"}},"'C:/Users/Administrator/Desktop/Sat/SatData/Upper_air/A_IUKN09BABJ300000_C_RJTD_20220130013517_60.bufr'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"out "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," Sounding.to_sharppy("),s("span",{style:{color:"#032F62"}},'"52836"'),s("span",{style:{color:"#24292E"}},", dtime, outdir)")])])]),s("button",{class:"collapse"})],-1),w=s("strong",null,"CyanideCN/TaxolLib",-1),T=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki github-dark vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# https://github.com/CyanideCN/TaxolLib/blob/main/upperair_bufr.py")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"import"),s("span",{style:{color:"#E1E4E8"}}," os")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"from"),s("span",{style:{color:"#E1E4E8"}}," pybufrkit.dataquery "),s("span",{style:{color:"#F97583"}},"import"),s("span",{style:{color:"#E1E4E8"}}," NodePathParser, DataQuerent")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"from"),s("span",{style:{color:"#E1E4E8"}}," pybufrkit.decoder "),s("span",{style:{color:"#F97583"}},"import"),s("span",{style:{color:"#E1E4E8"}}," Decoder")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"import"),s("span",{style:{color:"#E1E4E8"}}," numpy "),s("span",{style:{color:"#F97583"}},"as"),s("span",{style:{color:"#E1E4E8"}}," np")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"from"),s("span",{style:{color:"#E1E4E8"}}," pandas "),s("span",{style:{color:"#F97583"}},"import"),s("span",{style:{color:"#E1E4E8"}}," DataFrame")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"dump_msg"),s("span",{style:{color:"#E1E4E8"}},"(msg):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," np.array("),s("span",{style:{color:"#79B8FF"}},"list"),s("span",{style:{color:"#E1E4E8"}},"(msg.values())["),s("span",{style:{color:"#79B8FF"}},"0"),s("span",{style:{color:"#E1E4E8"}},"]["),s("span",{style:{color:"#79B8FF"}},"0"),s("span",{style:{color:"#E1E4E8"}},"], "),s("span",{style:{color:"#79B8FF"}},"float"),s("span",{style:{color:"#E1E4E8"}},").ravel()")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"safe_number"),s("span",{style:{color:"#E1E4E8"}},"(arr):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    nanpos "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," np.isnan(arr)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    arr_new "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," arr.copy()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"if"),s("span",{style:{color:"#E1E4E8"}}," nanpos.any():")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        arr_new[nanpos] "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"-"),s("span",{style:{color:"#79B8FF"}},"9999")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," arr_new")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"decimal_fmt"),s("span",{style:{color:"#E1E4E8"}},"(num):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#79B8FF"}},"{"),s("span",{style:{color:"#F97583"}},":.2f"),s("span",{style:{color:"#79B8FF"}},"}"),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#E1E4E8"}},".format(num)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"format_str"),s("span",{style:{color:"#E1E4E8"}},"(tup):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    tup "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"map"),s("span",{style:{color:"#E1E4E8"}},"(decimal_fmt, tup)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    fmt "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#79B8FF"}},"{"),s("span",{style:{color:"#F97583"}},":>7"),s("span",{style:{color:"#79B8FF"}},"}"),s("span",{style:{color:"#9ECBFF"}},","),s("span",{style:{color:"#79B8FF"}},"{"),s("span",{style:{color:"#F97583"}},":>10"),s("span",{style:{color:"#79B8FF"}},"}"),s("span",{style:{color:"#9ECBFF"}},","),s("span",{style:{color:"#79B8FF"}},"{"),s("span",{style:{color:"#F97583"}},":>10"),s("span",{style:{color:"#79B8FF"}},"}"),s("span",{style:{color:"#9ECBFF"}},","),s("span",{style:{color:"#79B8FF"}},"{"),s("span",{style:{color:"#F97583"}},":>10"),s("span",{style:{color:"#79B8FF"}},"}"),s("span",{style:{color:"#9ECBFF"}},","),s("span",{style:{color:"#79B8FF"}},"{"),s("span",{style:{color:"#F97583"}},":>10"),s("span",{style:{color:"#79B8FF"}},"}"),s("span",{style:{color:"#9ECBFF"}},","),s("span",{style:{color:"#79B8FF"}},"{"),s("span",{style:{color:"#F97583"}},":>10"),s("span",{style:{color:"#79B8FF"}},"}\\n"),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#E1E4E8"}},".format("),s("span",{style:{color:"#F97583"}},"*"),s("span",{style:{color:"#E1E4E8"}},"tup)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," fmt")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F97583"}},"class"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"SoundingDecoder"),s("span",{style:{color:"#E1E4E8"}},"("),s("span",{style:{color:"#79B8FF"}},"object"),s("span",{style:{color:"#E1E4E8"}},"):")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#79B8FF"}},"CODE_PRES"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'007004'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#79B8FF"}},"CODE_TMP"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'012101'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#79B8FF"}},"CODE_TD"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'012103'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#79B8FF"}},"CODE_HGT"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'010009'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#79B8FF"}},"CODE_WDIR"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'011001'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#79B8FF"}},"CODE_WSPD"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'011002'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#79B8FF"}},"CODE_BLOCK"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'001001'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#79B8FF"}},"CODE_ID"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'001002'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"__init__"),s("span",{style:{color:"#E1E4E8"}},"(self, file):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        decoder "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," Decoder()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"open"),s("span",{style:{color:"#E1E4E8"}},"("),s("span",{style:{color:"#FFAB70"}},"file"),s("span",{style:{color:"#E1E4E8"}},", "),s("span",{style:{color:"#9ECBFF"}},"'rb'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," decoder.process(f.read())")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f.close()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".id_list "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"._station_list()")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"_station_list"),s("span",{style:{color:"#E1E4E8"}},"(self):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        q "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," DataQuerent(NodePathParser())")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        wmo_block "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," q.query("),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg, "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"."),s("span",{style:{color:"#79B8FF"}},"CODE_BLOCK"),s("span",{style:{color:"#E1E4E8"}},").results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        wmo_id "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," q.query("),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg, "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"."),s("span",{style:{color:"#79B8FF"}},"CODE_ID"),s("span",{style:{color:"#E1E4E8"}},").results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"ravel"),s("span",{style:{color:"#E1E4E8"}},"(l):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"            "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," [i "),s("span",{style:{color:"#F97583"}},"for"),s("span",{style:{color:"#E1E4E8"}}," j "),s("span",{style:{color:"#F97583"}},"in"),s("span",{style:{color:"#E1E4E8"}}," l "),s("span",{style:{color:"#F97583"}},"for"),s("span",{style:{color:"#E1E4E8"}}," i "),s("span",{style:{color:"#F97583"}},"in"),s("span",{style:{color:"#E1E4E8"}}," j]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        id_list "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," ["),s("span",{style:{color:"#79B8FF"}},"str"),s("span",{style:{color:"#E1E4E8"}},"(i) "),s("span",{style:{color:"#F97583"}},"+"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"str"),s("span",{style:{color:"#E1E4E8"}},"(j).zfill("),s("span",{style:{color:"#79B8FF"}},"3"),s("span",{style:{color:"#E1E4E8"}},") "),s("span",{style:{color:"#F97583"}},"for"),s("span",{style:{color:"#E1E4E8"}}," i, j "),s("span",{style:{color:"#F97583"}},"in"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"zip"),s("span",{style:{color:"#E1E4E8"}},"(ravel(wmo_block.values()), ravel(wmo_id.values()))]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," np.array(id_list)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"_query"),s("span",{style:{color:"#E1E4E8"}},"(self, subset_num):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#79B8FF"}},"TEMPLATE"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'@["),s("span",{style:{color:"#79B8FF"}},"{}"),s("span",{style:{color:"#9ECBFF"}},"] > "),s("span",{style:{color:"#79B8FF"}},"{}"),s("span",{style:{color:"#9ECBFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        q "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," DataQuerent(NodePathParser())")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," DataFrame()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        pres_msg "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," q.query("),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg, "),s("span",{style:{color:"#79B8FF"}},"TEMPLATE"),s("span",{style:{color:"#E1E4E8"}},".format(subset_num, "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"."),s("span",{style:{color:"#79B8FF"}},"CODE_PRES"),s("span",{style:{color:"#E1E4E8"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df["),s("span",{style:{color:"#9ECBFF"}},"'pressure'"),s("span",{style:{color:"#E1E4E8"}},"] "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," dump_msg(pres_msg) "),s("span",{style:{color:"#F97583"}},"/"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"100")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        tmp_msg "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," q.query("),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg, "),s("span",{style:{color:"#79B8FF"}},"TEMPLATE"),s("span",{style:{color:"#E1E4E8"}},".format(subset_num, "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"."),s("span",{style:{color:"#79B8FF"}},"CODE_TMP"),s("span",{style:{color:"#E1E4E8"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df["),s("span",{style:{color:"#9ECBFF"}},"'temperature'"),s("span",{style:{color:"#E1E4E8"}},"] "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," dump_msg(tmp_msg) "),s("span",{style:{color:"#F97583"}},"-"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"273.15")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        td_msg "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," q.query("),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg, "),s("span",{style:{color:"#79B8FF"}},"TEMPLATE"),s("span",{style:{color:"#E1E4E8"}},".format(subset_num, "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"."),s("span",{style:{color:"#79B8FF"}},"CODE_TD"),s("span",{style:{color:"#E1E4E8"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df["),s("span",{style:{color:"#9ECBFF"}},"'dewpoint'"),s("span",{style:{color:"#E1E4E8"}},"] "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," dump_msg(td_msg) "),s("span",{style:{color:"#F97583"}},"-"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"273.15")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        hgt_msg "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," q.query("),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg, "),s("span",{style:{color:"#79B8FF"}},"TEMPLATE"),s("span",{style:{color:"#E1E4E8"}},".format(subset_num, "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"."),s("span",{style:{color:"#79B8FF"}},"CODE_HGT"),s("span",{style:{color:"#E1E4E8"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df["),s("span",{style:{color:"#9ECBFF"}},"'geopotential'"),s("span",{style:{color:"#E1E4E8"}},"] "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," dump_msg(hgt_msg)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        wdir_msg "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," q.query("),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg, "),s("span",{style:{color:"#79B8FF"}},"TEMPLATE"),s("span",{style:{color:"#E1E4E8"}},".format(subset_num, "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"."),s("span",{style:{color:"#79B8FF"}},"CODE_WDIR"),s("span",{style:{color:"#E1E4E8"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df["),s("span",{style:{color:"#9ECBFF"}},"'wind_direction'"),s("span",{style:{color:"#E1E4E8"}},"] "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," dump_msg(wdir_msg)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        wspd_msg "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," q.query("),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".msg, "),s("span",{style:{color:"#79B8FF"}},"TEMPLATE"),s("span",{style:{color:"#E1E4E8"}},".format(subset_num, "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"."),s("span",{style:{color:"#79B8FF"}},"CODE_WSPD"),s("span",{style:{color:"#E1E4E8"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df["),s("span",{style:{color:"#9ECBFF"}},"'wind_speed'"),s("span",{style:{color:"#E1E4E8"}},"] "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," dump_msg(wspd_msg)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#6A737D"}},"# Basic QC")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," df.fillna("),s("span",{style:{color:"#FFAB70"}},"value"),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}},"{"),s("span",{style:{color:"#9ECBFF"}},"'dewpoint'"),s("span",{style:{color:"#E1E4E8"}},":"),s("span",{style:{color:"#F97583"}},"-"),s("span",{style:{color:"#79B8FF"}},"9999"),s("span",{style:{color:"#E1E4E8"}},"}) "),s("span",{style:{color:"#6A737D"}},"# Fill missing dewpoint at high levels")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," df.interpolate("),s("span",{style:{color:"#FFAB70"}},"method"),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#9ECBFF"}},"'linear'"),s("span",{style:{color:"#E1E4E8"}},", "),s("span",{style:{color:"#FFAB70"}},"limit_direction"),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#9ECBFF"}},"'forward'"),s("span",{style:{color:"#E1E4E8"}},", "),s("span",{style:{color:"#FFAB70"}},"axis"),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#79B8FF"}},"0"),s("span",{style:{color:"#E1E4E8"}},").drop_duplicates("),s("span",{style:{color:"#9ECBFF"}},"'geopotential'"),s("span",{style:{color:"#E1E4E8"}},").sort_values("),s("span",{style:{color:"#FFAB70"}},"by"),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#9ECBFF"}},"'geopotential'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," df.fillna("),s("span",{style:{color:"#F97583"}},"-"),s("span",{style:{color:"#79B8FF"}},"9999"),s("span",{style:{color:"#E1E4E8"}},") "),s("span",{style:{color:"#6A737D"}},"# Fill Nans in starting level")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"query"),s("span",{style:{color:"#E1E4E8"}},"(self, station_id):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#F97583"}},"if"),s("span",{style:{color:"#E1E4E8"}}," station_id "),s("span",{style:{color:"#F97583"}},"not"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"in"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".id_list:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"            "),s("span",{style:{color:"#F97583"}},"raise"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"ValueError"),s("span",{style:{color:"#E1E4E8"}},"("),s("span",{style:{color:"#9ECBFF"}},"'Station not found'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        id_idx "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," (station_id "),s("span",{style:{color:"#F97583"}},"=="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".id_list).nonzero()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        subset_num "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," id_idx["),s("span",{style:{color:"#79B8FF"}},"0"),s("span",{style:{color:"#E1E4E8"}},"]["),s("span",{style:{color:"#79B8FF"}},"0"),s("span",{style:{color:"#E1E4E8"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},"._query(subset_num)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    "),s("span",{style:{color:"#F97583"}},"def"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#B392F0"}},"to_sharppy"),s("span",{style:{color:"#E1E4E8"}},"(self, station_id, dtime, outdir):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        df "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"self"),s("span",{style:{color:"#E1E4E8"}},".query(station_id)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        fname "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'SKEWT_'"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"+"),s("span",{style:{color:"#E1E4E8"}}," dtime.strftime("),s("span",{style:{color:"#9ECBFF"}},"'%Y%m"),s("span",{style:{color:"#79B8FF"}},"%d"),s("span",{style:{color:"#9ECBFF"}},"%H0000'"),s("span",{style:{color:"#E1E4E8"}},") "),s("span",{style:{color:"#F97583"}},"+"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#9ECBFF"}},"'_'"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#F97583"}},"+"),s("span",{style:{color:"#E1E4E8"}}," station_id "),s("span",{style:{color:"#F97583"}},"+"),s("span",{style:{color:"#9ECBFF"}},"'.txt'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        outpath "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," os.path.join(outdir, fname)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"open"),s("span",{style:{color:"#E1E4E8"}},"(outpath, "),s("span",{style:{color:"#9ECBFF"}},"'w'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f.write("),s("span",{style:{color:"#9ECBFF"}},"'%TITLE%"),s("span",{style:{color:"#79B8FF"}},"\\n"),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f.write("),s("span",{style:{color:"#9ECBFF"}},"' "),s("span",{style:{color:"#79B8FF"}},"{}"),s("span",{style:{color:"#9ECBFF"}},"   "),s("span",{style:{color:"#79B8FF"}},"{}\\n\\n"),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#E1E4E8"}},".format(station_id, dtime.strftime("),s("span",{style:{color:"#9ECBFF"}},"'%y%m"),s("span",{style:{color:"#79B8FF"}},"%d"),s("span",{style:{color:"#9ECBFF"}},"/%H%M'"),s("span",{style:{color:"#E1E4E8"}},")))")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f.write("),s("span",{style:{color:"#9ECBFF"}},"'   LEVEL       HGHT       TEMP       DWPT       WDIR       WSPD"),s("span",{style:{color:"#79B8FF"}},"\\n"),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f.write("),s("span",{style:{color:"#9ECBFF"}},"'-------------------------------------------------------------------"),s("span",{style:{color:"#79B8FF"}},"\\n"),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f.write("),s("span",{style:{color:"#9ECBFF"}},"'%RAW%"),s("span",{style:{color:"#79B8FF"}},"\\n"),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#F97583"}},"for"),s("span",{style:{color:"#E1E4E8"}}," data "),s("span",{style:{color:"#F97583"}},"in"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"zip"),s("span",{style:{color:"#E1E4E8"}},"(safe_number(df["),s("span",{style:{color:"#9ECBFF"}},"'pressure'"),s("span",{style:{color:"#E1E4E8"}},"]), safe_number(df["),s("span",{style:{color:"#9ECBFF"}},"'geopotential'"),s("span",{style:{color:"#E1E4E8"}},"]),")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"                        safe_number(df["),s("span",{style:{color:"#9ECBFF"}},"'temperature'"),s("span",{style:{color:"#E1E4E8"}},"]), safe_number(df["),s("span",{style:{color:"#9ECBFF"}},"'dewpoint'"),s("span",{style:{color:"#E1E4E8"}},"]),")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"                        safe_number(df["),s("span",{style:{color:"#9ECBFF"}},"'wind_direction'"),s("span",{style:{color:"#E1E4E8"}},"]), safe_number(df["),s("span",{style:{color:"#9ECBFF"}},"'wind_speed'"),s("span",{style:{color:"#E1E4E8"}},"] "),s("span",{style:{color:"#F97583"}},"*"),s("span",{style:{color:"#E1E4E8"}}," "),s("span",{style:{color:"#79B8FF"}},"1.9438"),s("span",{style:{color:"#E1E4E8"}},")):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"            formatted "),s("span",{style:{color:"#F97583"}},"="),s("span",{style:{color:"#E1E4E8"}}," format_str(data)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"            f.write(formatted)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f.write("),s("span",{style:{color:"#9ECBFF"}},"'"),s("span",{style:{color:"#79B8FF"}},"%E"),s("span",{style:{color:"#9ECBFF"}},"ND%'"),s("span",{style:{color:"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        f.close()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"        "),s("span",{style:{color:"#F97583"}},"return"),s("span",{style:{color:"#E1E4E8"}}," outpath")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# https://github.com/CyanideCN/TaxolLib/blob/main/upperair_bufr.py")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," os")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," pybufrkit.dataquery "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," NodePathParser, DataQuerent")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," pybufrkit.decoder "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," Decoder")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," numpy "),s("span",{style:{color:"#D73A49"}},"as"),s("span",{style:{color:"#24292E"}}," np")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," pandas "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," DataFrame")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"dump_msg"),s("span",{style:{color:"#24292E"}},"(msg):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," np.array("),s("span",{style:{color:"#005CC5"}},"list"),s("span",{style:{color:"#24292E"}},"(msg.values())["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"], "),s("span",{style:{color:"#005CC5"}},"float"),s("span",{style:{color:"#24292E"}},").ravel()")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"safe_number"),s("span",{style:{color:"#24292E"}},"(arr):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    nanpos "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," np.isnan(arr)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    arr_new "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," arr.copy()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," nanpos.any():")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        arr_new[nanpos] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"9999")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," arr_new")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"decimal_fmt"),s("span",{style:{color:"#24292E"}},"(num):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#D73A49"}},":.2f"),s("span",{style:{color:"#005CC5"}},"}"),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#24292E"}},".format(num)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"format_str"),s("span",{style:{color:"#24292E"}},"(tup):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    tup "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"map"),s("span",{style:{color:"#24292E"}},"(decimal_fmt, tup)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    fmt "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#D73A49"}},":>7"),s("span",{style:{color:"#005CC5"}},"}"),s("span",{style:{color:"#032F62"}},","),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#D73A49"}},":>10"),s("span",{style:{color:"#005CC5"}},"}"),s("span",{style:{color:"#032F62"}},","),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#D73A49"}},":>10"),s("span",{style:{color:"#005CC5"}},"}"),s("span",{style:{color:"#032F62"}},","),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#D73A49"}},":>10"),s("span",{style:{color:"#005CC5"}},"}"),s("span",{style:{color:"#032F62"}},","),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#D73A49"}},":>10"),s("span",{style:{color:"#005CC5"}},"}"),s("span",{style:{color:"#032F62"}},","),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#D73A49"}},":>10"),s("span",{style:{color:"#005CC5"}},"}\\n"),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#24292E"}},".format("),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}},"tup)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," fmt")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"class"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"SoundingDecoder"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#005CC5"}},"object"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#005CC5"}},"CODE_PRES"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'007004'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#005CC5"}},"CODE_TMP"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'012101'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#005CC5"}},"CODE_TD"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'012103'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#005CC5"}},"CODE_HGT"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'010009'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#005CC5"}},"CODE_WDIR"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'011001'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#005CC5"}},"CODE_WSPD"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'011002'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#005CC5"}},"CODE_BLOCK"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'001001'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#005CC5"}},"CODE_ID"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'001002'")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"__init__"),s("span",{style:{color:"#24292E"}},"(self, file):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        decoder "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," Decoder()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"open"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#E36209"}},"file"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#032F62"}},"'rb'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," decoder.process(f.read())")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f.close()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".id_list "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"._station_list()")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"_station_list"),s("span",{style:{color:"#24292E"}},"(self):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        q "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," DataQuerent(NodePathParser())")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        wmo_block "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," q.query("),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg, "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"."),s("span",{style:{color:"#005CC5"}},"CODE_BLOCK"),s("span",{style:{color:"#24292E"}},").results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        wmo_id "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," q.query("),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg, "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"."),s("span",{style:{color:"#005CC5"}},"CODE_ID"),s("span",{style:{color:"#24292E"}},").results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"ravel"),s("span",{style:{color:"#24292E"}},"(l):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," [i "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," j "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," l "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," i "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," j]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        id_list "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," ["),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(i) "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"str"),s("span",{style:{color:"#24292E"}},"(j).zfill("),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#24292E"}},") "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," i, j "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"zip"),s("span",{style:{color:"#24292E"}},"(ravel(wmo_block.values()), ravel(wmo_id.values()))]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," np.array(id_list)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"_query"),s("span",{style:{color:"#24292E"}},"(self, subset_num):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#005CC5"}},"TEMPLATE"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'@["),s("span",{style:{color:"#005CC5"}},"{}"),s("span",{style:{color:"#032F62"}},"] > "),s("span",{style:{color:"#005CC5"}},"{}"),s("span",{style:{color:"#032F62"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        q "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," DataQuerent(NodePathParser())")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," DataFrame()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        pres_msg "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," q.query("),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg, "),s("span",{style:{color:"#005CC5"}},"TEMPLATE"),s("span",{style:{color:"#24292E"}},".format(subset_num, "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"."),s("span",{style:{color:"#005CC5"}},"CODE_PRES"),s("span",{style:{color:"#24292E"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df["),s("span",{style:{color:"#032F62"}},"'pressure'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," dump_msg(pres_msg) "),s("span",{style:{color:"#D73A49"}},"/"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"100")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        tmp_msg "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," q.query("),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg, "),s("span",{style:{color:"#005CC5"}},"TEMPLATE"),s("span",{style:{color:"#24292E"}},".format(subset_num, "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"."),s("span",{style:{color:"#005CC5"}},"CODE_TMP"),s("span",{style:{color:"#24292E"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df["),s("span",{style:{color:"#032F62"}},"'temperature'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," dump_msg(tmp_msg) "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"273.15")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        td_msg "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," q.query("),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg, "),s("span",{style:{color:"#005CC5"}},"TEMPLATE"),s("span",{style:{color:"#24292E"}},".format(subset_num, "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"."),s("span",{style:{color:"#005CC5"}},"CODE_TD"),s("span",{style:{color:"#24292E"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df["),s("span",{style:{color:"#032F62"}},"'dewpoint'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," dump_msg(td_msg) "),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"273.15")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        hgt_msg "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," q.query("),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg, "),s("span",{style:{color:"#005CC5"}},"TEMPLATE"),s("span",{style:{color:"#24292E"}},".format(subset_num, "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"."),s("span",{style:{color:"#005CC5"}},"CODE_HGT"),s("span",{style:{color:"#24292E"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df["),s("span",{style:{color:"#032F62"}},"'geopotential'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," dump_msg(hgt_msg)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        wdir_msg "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," q.query("),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg, "),s("span",{style:{color:"#005CC5"}},"TEMPLATE"),s("span",{style:{color:"#24292E"}},".format(subset_num, "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"."),s("span",{style:{color:"#005CC5"}},"CODE_WDIR"),s("span",{style:{color:"#24292E"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df["),s("span",{style:{color:"#032F62"}},"'wind_direction'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," dump_msg(wdir_msg)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        wspd_msg "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," q.query("),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".msg, "),s("span",{style:{color:"#005CC5"}},"TEMPLATE"),s("span",{style:{color:"#24292E"}},".format(subset_num, "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"."),s("span",{style:{color:"#005CC5"}},"CODE_WSPD"),s("span",{style:{color:"#24292E"}},")).results")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df["),s("span",{style:{color:"#032F62"}},"'wind_speed'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," dump_msg(wspd_msg)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#6A737D"}},"# Basic QC")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," df.fillna("),s("span",{style:{color:"#E36209"}},"value"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"{"),s("span",{style:{color:"#032F62"}},"'dewpoint'"),s("span",{style:{color:"#24292E"}},":"),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"9999"),s("span",{style:{color:"#24292E"}},"}) "),s("span",{style:{color:"#6A737D"}},"# Fill missing dewpoint at high levels")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," df.interpolate("),s("span",{style:{color:"#E36209"}},"method"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},"'linear'"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#E36209"}},"limit_direction"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},"'forward'"),s("span",{style:{color:"#24292E"}},", "),s("span",{style:{color:"#E36209"}},"axis"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},").drop_duplicates("),s("span",{style:{color:"#032F62"}},"'geopotential'"),s("span",{style:{color:"#24292E"}},").sort_values("),s("span",{style:{color:"#E36209"}},"by"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},"'geopotential'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," df.fillna("),s("span",{style:{color:"#D73A49"}},"-"),s("span",{style:{color:"#005CC5"}},"9999"),s("span",{style:{color:"#24292E"}},") "),s("span",{style:{color:"#6A737D"}},"# Fill Nans in starting level")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"query"),s("span",{style:{color:"#24292E"}},"(self, station_id):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," station_id "),s("span",{style:{color:"#D73A49"}},"not"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".id_list:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            "),s("span",{style:{color:"#D73A49"}},"raise"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"ValueError"),s("span",{style:{color:"#24292E"}},"("),s("span",{style:{color:"#032F62"}},"'Station not found'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        id_idx "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," (station_id "),s("span",{style:{color:"#D73A49"}},"=="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".id_list).nonzero()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        subset_num "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," id_idx["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]["),s("span",{style:{color:"#005CC5"}},"0"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},"._query(subset_num)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"to_sharppy"),s("span",{style:{color:"#24292E"}},"(self, station_id, dtime, outdir):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        df "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"self"),s("span",{style:{color:"#24292E"}},".query(station_id)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        fname "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'SKEWT_'"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," dtime.strftime("),s("span",{style:{color:"#032F62"}},"'%Y%m"),s("span",{style:{color:"#005CC5"}},"%d"),s("span",{style:{color:"#032F62"}},"%H0000'"),s("span",{style:{color:"#24292E"}},") "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'_'"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}}," station_id "),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#032F62"}},"'.txt'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        outpath "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," os.path.join(outdir, fname)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"open"),s("span",{style:{color:"#24292E"}},"(outpath, "),s("span",{style:{color:"#032F62"}},"'w'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f.write("),s("span",{style:{color:"#032F62"}},"'%TITLE%"),s("span",{style:{color:"#005CC5"}},"\\n"),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f.write("),s("span",{style:{color:"#032F62"}},"' "),s("span",{style:{color:"#005CC5"}},"{}"),s("span",{style:{color:"#032F62"}},"   "),s("span",{style:{color:"#005CC5"}},"{}\\n\\n"),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#24292E"}},".format(station_id, dtime.strftime("),s("span",{style:{color:"#032F62"}},"'%y%m"),s("span",{style:{color:"#005CC5"}},"%d"),s("span",{style:{color:"#032F62"}},"/%H%M'"),s("span",{style:{color:"#24292E"}},")))")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f.write("),s("span",{style:{color:"#032F62"}},"'   LEVEL       HGHT       TEMP       DWPT       WDIR       WSPD"),s("span",{style:{color:"#005CC5"}},"\\n"),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f.write("),s("span",{style:{color:"#032F62"}},"'-------------------------------------------------------------------"),s("span",{style:{color:"#005CC5"}},"\\n"),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f.write("),s("span",{style:{color:"#032F62"}},"'%RAW%"),s("span",{style:{color:"#005CC5"}},"\\n"),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"for"),s("span",{style:{color:"#24292E"}}," data "),s("span",{style:{color:"#D73A49"}},"in"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"zip"),s("span",{style:{color:"#24292E"}},"(safe_number(df["),s("span",{style:{color:"#032F62"}},"'pressure'"),s("span",{style:{color:"#24292E"}},"]), safe_number(df["),s("span",{style:{color:"#032F62"}},"'geopotential'"),s("span",{style:{color:"#24292E"}},"]),")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"                        safe_number(df["),s("span",{style:{color:"#032F62"}},"'temperature'"),s("span",{style:{color:"#24292E"}},"]), safe_number(df["),s("span",{style:{color:"#032F62"}},"'dewpoint'"),s("span",{style:{color:"#24292E"}},"]),")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"                        safe_number(df["),s("span",{style:{color:"#032F62"}},"'wind_direction'"),s("span",{style:{color:"#24292E"}},"]), safe_number(df["),s("span",{style:{color:"#032F62"}},"'wind_speed'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"*"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"1.9438"),s("span",{style:{color:"#24292E"}},")):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            formatted "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," format_str(data)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"            f.write(formatted)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f.write("),s("span",{style:{color:"#032F62"}},"'"),s("span",{style:{color:"#005CC5"}},"%E"),s("span",{style:{color:"#032F62"}},"ND%'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        f.close()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"return"),s("span",{style:{color:"#24292E"}}," outpath")])])]),s("button",{class:"collapse"})],-1);function q(o,P,S,v,t,k){const p=u,c=E;return d(),C(c,{frontmatter:t.frontmatter,data:t.data},{"main-content-md":n(()=>[s("h3",f,[l("# 前情提要 "),r(p,{class:"header-anchor",href:"#前情提要","aria-label":'Permalink to "# 前情提要"'},{default:n(()=>[l("​")]),_:1})]),_,D,B,A,g,h,b,s("p",null,[l("这里贴一份upperair_bufr.py，还请大家给Pyy老师一个Star！"),r(p,{href:"https://github.com/CyanideCN/TaxolLib/blob/main/upperair_bufr.py",target:"_blank",rel:"noreferrer"},{default:n(()=>[w]),_:1})]),T]),"main-header":n(()=>[a(o.$slots,"main-header")]),"main-header-after":n(()=>[a(o.$slots,"main-header-after")]),"main-nav":n(()=>[a(o.$slots,"main-nav")]),"main-content":n(()=>[a(o.$slots,"main-content")]),"main-content-after":n(()=>[a(o.$slots,"main-content-after")]),"main-nav-before":n(()=>[a(o.$slots,"main-nav-before")]),"main-nav-after":n(()=>[a(o.$slots,"main-nav-after")]),comment:n(()=>[a(o.$slots,"comment")]),footer:n(()=>[a(o.$slots,"footer")]),aside:n(()=>[a(o.$slots,"aside")]),"aside-custom":n(()=>[a(o.$slots,"aside-custom")]),default:n(()=>[a(o.$slots,"default")]),_:3},8,["frontmatter","data"])}const M=y(m,[["render",q]]);export{e as data,M as default};
