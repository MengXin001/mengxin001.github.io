<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>配置气象云图绘图工具-SatimaV4</title>
      <link href="2021/02/satima.html/"/>
      <url>2021/02/satima.html/</url>
      
        <content type="html"><![CDATA[<h2 id="关于"><a href="#关于" class="headerlink" title="关于"></a>关于</h2><p>SatimaV4由<a href="https://github.com/CyanideCN/SatimaV4" target="_blank" rel="noopener">CyanideCN</a>制作，在Linux和Windows均可实现高效的对Himawari8的DAT数据进行绘制，自带了15种色阶。此外在进行额外的插件补充后支持更多卫星如FY-4A的HDF数据进行绘图。本文将尽可能详细的写出步骤，作为一篇避坑指南。</p><pre><code>//自带色阶1.CA 2.NRL89 3.RAMMB 4.CC 5.CWBM 6.O 7.BD 8.RBTOP 9.NHC 10.RB 11.MB 12.AVN 13.BDCOLOR 14.COLOR 15.BW</code></pre><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ul><li>Python 3.6+</li><li>Pip3</li></ul><h3 id="必备库"><a href="#必备库" class="headerlink" title="必备库"></a>必备库</h3><p>建议使用华为云开源镜像站作为Pypi安装的软件源，<a href="https://mirrors.huaweicloud.com/" target="_blank" rel="noopener">方法见</a></p><pre><code class="BASH">sudo apt-get updatesudo apt-get install proj  # Proj 4.9.0</code></pre><pre><code class="Python">dask   #可能需要执行 pip3 install &quot;dask[array]&quot; --upgradetoolznumpynetCDF4matplotlib==3.3.3cartopy==0.18.0</code></pre><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre><code class="bash">git clone https://github.com/CyanideCN/SatimaV4.git</code></pre><p>安装<code>Courier New</code>字体到系统中，没有该字体也不会影响正常出图。<br><code>Cartopy</code>将会从naciscdn获取海岸线数据，在国内访问速度较慢。建议手动下载文件并解压放置于自己当前用户的<code>/home/pi/.local/share/cartopy/shapefiles/natural_earth/physical</code>路径，Ps:用户名记得改成自己的！<a href="https://cdn.jsdelivr.net/gh/MengXin001/CDN@1.8.0.2/safe/ne_10m_coastline.zip" target="_blank" rel="noopener">CoastLine国内下载链接</a><br>核对文件</p><pre><code>pi@nanopik2-s905:~$ cd /home/pi/.local/share/cartopy/shapefiles/natural_earth/physicalpi@nanopik2-s905:~/.local/share/cartopy/shapefiles/natural_earth/physical$ lsne_10m_coastline.cpg  ne_10m_coastline.dbf  ne_10m_coastline.prj  ne_10m_coastline.README.html  ne_10m_coastline.shp  ne_10m_coastline.shx  ne_10m_coastline.VERSION.txt</code></pre><p>存档一份H8DAT数据（在P-TREE或NICT下载）进入到SatimaV4目录。</p><pre><code class="Python">pi@nanopik2-s905:~$ cd /Desktop/SatimaV4pi@nanopik2-s905:~/Desktop/SatimaV4$ python3 Satima.py # 运行Loaded module satima.satellites.abiLoaded module satima.satellites.ahiLoaded module satima.satellites.mersiLoaded module satima.satellites.microwaveLoaded module satima.satellites.viirs----------------------------SatimaV4 restructured by PY. Version 1.0----------------------------Enter data directory, press enter to use current directory: /home/pi/Desktop/SatimaV4  # 输入数据所在目录(绝对路径)1.[H8][TARGET] 2020.12.20 07:45 # 显示数据信息Enter file index: 1 # 选择绘制数据序号[IR][BAND13] # 数据通道1.CA 2.NRL89 3.RAMMB 4.CC 5.CWBM 6.O 7.BD 8.RBTOP 9.NHC 10.RB 11.MB 12.AVN 13.BDCOLOR 14.COLOR 15.BW # 自带色阶Enter image options, separated by comma: 1# 选择色阶Task(band=13, georange=None, cmap=&#39;CA&#39;)findfont: Font family [&#39;Courier New&#39;] not found. Falling back to DejaVu Sans.20.620737233577472# 绘制完成，输出在数据同一目录</code></pre>]]></content>
      
      
      <categories>
          
          <category> Meteorology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Himawari8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>读取米家蓝牙温湿度计数据</title>
      <link href="2021/02/xm.html/"/>
      <url>2021/02/xm.html/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>由于米家APP云端只能存储半年的传感器数据，所以给出一个可以进行本地归档的方案</p><ul><li>通过BLE连接温湿度计不需要进行米家APP上的配对</li><li>获取数据的设备需要支持蓝牙4.0或以上协议</li><li>推荐使用树莓派等各类开发板进行处理归档</li></ul><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><p>这里使用iOS端上的<code>LightBlue</code>软件进行数据获取<br>在<code>Peripherals</code>页面搜索找到编号为<code>LYWSD03MMC</code>的设备连接。<br>连接传感器成功后找到<code>Temperature and Humidity</code>项(<code>UUID: EBE0CCC1-7A0A-4B0C-8A1A-6FF2997DA3A6</code>)</p><div class="img-wrap"><div class="frame-wrap" id="iphone11"><img class="img lazyload" src="https://gitee.com//MengXin546/CDN/raw/master/img/DG0W~SMQYT2@G_{}~PEFB7G.jpg" class="lazyload" data-srcset="https://gitee.com//MengXin546/CDN/raw/master/img/DG0W~SMQYT2@G_{}~PEFB7G.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="/><div class="frame"></div></div></div><p>点击<code>Listen for notifications</code>监听传感器广播的温湿度数据。数据示例</p><pre><code>0x240946170B0x250946170B0x250946170B0x240946170B0x1F0946640B0x000000 ---空数据</code></pre><h2 id="解码"><a href="#解码" class="headerlink" title="解码"></a>解码</h2><p>以Hex数据<code>1F0946640B</code>为例<br>将十六进制数据两两分组得五组数据将其编号</p><pre><code>1F0946640B</code></pre><h4 id="温度数据"><a href="#温度数据" class="headerlink" title="温度数据"></a>温度数据</h4><p>传感器精度为小数点后两位小数，官方取小数点后一位数据，这里可以自行选择精度。<br>    1.取分组后的数据前两组<code>1F</code> <code>09</code>。<br>    2.将数据反序排列为<code>09</code> <code>1F</code>。（十六进制第一位不能为0，转换时舍去0实际输入<code>91F</code>）<br>    3.转为十进制得到数字<code>2335</code>。<br>    4.十进制数字÷100得<code>23.35</code>，此数据即为当前得温度数据</p><h4 id="湿度数据"><a href="#湿度数据" class="headerlink" title="湿度数据"></a>湿度数据</h4><p>1.取分组后的第三组数据<code>46</code><br>2.转换为十进制数据得<code>70</code>，即为当前湿度数据。<br>后面两组数据暂时没有摸索出来用途，0B组似乎是固定数值没有变动。</p><h2 id="On-Raspberry"><a href="#On-Raspberry" class="headerlink" title="On Raspberry"></a>On Raspberry</h2><p>推荐使用Gatttool与Bluez组合，<a href="https://blog.csdn.net/qq_33433070/article/details/78668105" target="_blank" rel="noopener">参考文章</a>。<br>当然上述只是对数据的解码提出的思路，进行本地归档还需要带家用Python或者其他语言进行处理</p>]]></content>
      
      
      <categories>
          
          <category> Bluetooth </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bluetooth </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于近日</title>
      <link href="2021/01/recent.html/"/>
      <url>2021/01/recent.html/</url>
      
        <content type="html"><![CDATA[<h3 id="看板娘"><a href="#看板娘" class="headerlink" title="看板娘"></a>看板娘</h3><p>自建了Live2D看板娘的CDN，现在的首页看起来没有以前那么空白了(咕</p><h3 id="评论系统"><a href="#评论系统" class="headerlink" title="评论系统"></a>评论系统</h3><p>打算继续使用Valine系统，修改一些评论区的样式，包括系统&amp;浏览器信息显示部分等等，评论内加入了<code>Bilibili热词系列</code>的表情包</p><h3 id="首页样式"><a href="#首页样式" class="headerlink" title="首页样式"></a>首页样式</h3><p>参照了孤影墨香的样式配色以及滑块等</p><h3 id="balabala"><a href="#balabala" class="headerlink" title="balabala"></a>balabala</h3><p>从去年年底开始在完善2020年的气象年度回顾记录，小窝一直闲置的没有去维护，放假后好好打理一番这次一定</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在NanoPi上安装Scrapy框架</title>
      <link href="2020/07/scrapy.html/"/>
      <url>2020/07/scrapy.html/</url>
      
        <content type="html"><![CDATA[<p>以下操作在Armbian系统下进行，系统已经预装完成Python3.8。<br>1.安装<code>pip</code></p><pre><code>sudo apt-get install python3-pip</code></pre><p>完成后输入<code>pip3 -V</code>检查是否安装成功，如果显示出当前<code>pip</code>版本则安装成功<br>2.安装Dev套件</p><pre><code>sudo apt-get install python3-dev</code></pre><p>没有开发依赖项在<code>Twisted</code>安装中会提示如下报错。被该报错困扰许久……<img src="/images/cry.gif" class="lazyload" data-srcset="/images/cry.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""> <img src="/images/cry.gif" class="lazyload" data-srcset="/images/cry.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><pre><code class="BASH">build/temp.linux-x86_64-2.7/twisted/test/raiser.o twisted/test/raiser.c:4:20: fatal error: Python.h: No such file or directory #include “Python.h” ^ compilation terminated. error: command ‘x86_64-linux-gnu-gcc’ failed with exit status 1</code></pre><p>3.安装Scarpy</p><pre><code>pip3 install Scarpy</code></pre>]]></content>
      
      
      <categories>
          
          <category> NanoPi </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NanoPi K2 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给NanoPiK2更换国内软件源</title>
      <link href="2020/07/npik2.html/"/>
      <url>2020/07/npik2.html/</url>
      
        <content type="html"><![CDATA[<p>1.使用SSH或者在图形桌面下使用终端连接到你的NanoPiK2上<br>2.备份官方软件源</p><pre><code>sudo cp /etc/apt/sources.list /etc/apt/sources.backup.list</code></pre><p>3.更换软件源<br>这里使用<a href="https://mirrors.huaweicloud.com/" target="_blank" rel="noopener">华为开源镜像站</a>的镜像</p><pre><code>sudo nano /etc/apt/sources.list</code></pre><p>可以单独将<code>http://ports.ubuntu.com/</code>替换为<code>https://mirrors.huaweicloud.com/ubuntu-ports/</code><br>也可以把全部内容用下面的内容替换</p><pre><code>deb https://mirrors.huaweicloud.com/ubuntu-ports/ focal main restricted universe multiverse#deb-src http://ports.ubuntu.com/ focal main restricted universe multiversedeb https://mirrors.huaweicloud.com/ubuntu-ports/ focal-security main restricted universe multiverse#deb-src http://ports.ubuntu.com/ focal-security main restricted universe multiversedeb https://mirrors.huaweicloud.com/ubuntu-ports/ focal-updates main restricted universe multiverse#deb-src http://ports.ubuntu.com/ focal-updates main restricted universe multiversedeb https://mirrors.huaweicloud.com/ubuntu-ports/ focal-backports main restricted universe multiverse#deb-src http://ports.ubuntu.com/ focal-backports main restricted universe multiverse</code></pre><p>4.完成后使用<code>Ctrl+X</code>退出并输入<code>Y</code>+回车保存文件<br>5.更新软件源</p><pre><code>sudo apt-get update</code></pre><hr><p>附一份官方源地址备份<img src="/images/pp-9.png" class="lazyload" data-srcset="/images/pp-9.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><pre><code class="sources.backup.list">deb http://ports.ubuntu.com/ focal main restricted universe multiverse#deb-src http://ports.ubuntu.com/ focal main restricted universe multiversedeb http://ports.ubuntu.com/ focal-security main restricted universe multiverse#deb-src http://ports.ubuntu.com/ focal-security main restricted universe multiversedeb http://ports.ubuntu.com/ focal-updates main restricted universe multiverse#deb-src http://ports.ubuntu.com/ focal-updates main restricted universe multiversedeb http://ports.ubuntu.com/ focal-backports main restricted universe multiverse#deb-src http://ports.ubuntu.com/ focal-backports main restricted universe multiverse</code></pre>]]></content>
      
      
      <categories>
          
          <category> NanoPi </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Armbian </tag>
            
            <tag> NanoPi K2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于Hexo部署报错</title>
      <link href="2020/03/depoly.html/"/>
      <url>2020/03/depoly.html/</url>
      
        <content type="html"><![CDATA[<h2 id="Hexo部署报错笔记"><a href="#Hexo部署报错笔记" class="headerlink" title="Hexo部署报错笔记"></a>Hexo部署报错笔记</h2><a id="more"></a><pre><code class="BASH">fatal: Unable to create &#39;C:/Users/Administrator/Desktop/Hexo-theme-sakura-master/.deploy_git/.git/index.lock&#39;: File exists.Another git process seems to be running in this repository, e.g.an editor opened by &#39;git commit&#39;. Please make sure all processesare terminated then try again. If it still fails, a git processmay have crashed in this repository earlier:remove the file manually to continue.FATAL Something&#39;s wrong. Maybe you can find the solution here: https://hexo.io/docs/troubleshooting.html</code></pre><p>由于上一次部署意外关闭造成该报错，显示隐藏文件夹并删除<code>.deploy_git/.git/index.lock</code>文件即可<br><img src="https://i.loli.net/2020/03/21/ktwgru57FDSf6Oo.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/21/ktwgru57FDSf6Oo.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Note </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在树莓派上安装AdGuardHome</title>
      <link href="2020/03/guard.html/"/>
      <url>2020/03/guard.html/</url>
      
        <content type="html"><![CDATA[<h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>连接你的树莓派，从Github获取发布的AdGuardHome</p><a id="more"></a><center><iframe frameborder="0" scrolling="0" allowtransparency="true" src="https://api.2heng.xin/github-card/?repo=AdguardTeam/AdGuardHome" width="400" height="153" style="margin-left: 50%; transform: translateX(-50%);"></iframe></center><pre><code class="BASH">wget https://github.com/AdguardTeam/AdGuardHome/releases/download/v0.101.0/AdGuardHome_linux_arm.tar.gz</code></pre><pre><code class="BASH"># 解压tar -xvzf AdGuardHome_linux_arm.tar.gzcd AdGuardHome# screen后台运行screen -S Adsudo ./AdGuardHome</code></pre><h2 id="AdGuardHome配置"><a href="#AdGuardHome配置" class="headerlink" title="AdGuardHome配置"></a>AdGuardHome配置</h2><p>访问<code>树莓派内网IP:3000</code>进入后台<br>设置账户密码，建议在路由器中分配静态内网IP给树莓派。<br><img src="https://i.loli.net/2020/03/20/mdPE4kcgeuhax3o.jpg" class="lazyload" data-srcset="https://i.loli.net/2020/03/20/mdPE4kcgeuhax3o.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Set"><br>完成设置后Login进入控制台<br><img src="https://i.loli.net/2020/03/20/PiFQIGW2mnbVD63.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/20/PiFQIGW2mnbVD63.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Main"></p><h2 id="DNS配置"><a href="#DNS配置" class="headerlink" title="DNS配置"></a>DNS配置</h2><p>在过滤器中勾选自带的过滤器并应用。<br>还可以添加Adgk的广告过滤规则。添加以下链接并应用更新规则。建议修改规则自动更新时间为24Hours</p><pre><code>https://gitee.com/banbendalao/adguard/raw/master/ADgk.txt</code></pre><p>在DNS设置中设置上游DNS，不推荐使用默认的CloudFlareDNS，可以使用以下国内的公共DNS</p><pre><code>Ali DNS: 223.5.5.5;223.6.6.6Baidu DNS: 180.76.76.76Tencent DNS: 119.29.29.29oneDNS: 117.50.11.11CNNIC sDNS: 1.2.4.8114DNS: 114.114.114.114(推荐设置为备用DNS)</code></pre><p>点击测试DNS服务器可用后，应用设置。</p><h2 id="设备接入"><a href="#设备接入" class="headerlink" title="设备接入"></a>设备接入</h2><p>将需要接入的设备WIFIDNS设置为树莓派的内网IP即可，在AdGuardHome后台有详细的设置教程。</p><h2 id="拦截追踪"><a href="#拦截追踪" class="headerlink" title="拦截追踪"></a>拦截追踪</h2><p>接入设备后，访问一些网站就可以在AdGuardHome后台看到拦截的情况了。这是使用一晚上拦截追踪的情况。<br><img src="https://i.loli.net/2020/03/20/DZEFyMPQmw9pO2C.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/20/DZEFyMPQmw9pO2C.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><table><thead><tr><th>追踪器地址</th><th>拦截次数</th></tr></thead><tbody><tr><td>pingma.qq.com</td><td>121</td></tr><tr><td>pos.baidu.com</td><td>97</td></tr><tr><td>mqqeve.beacon.qq.com</td><td>95</td></tr><tr><td>ieventlog.beacon.qq.com</td><td>81</td></tr><tr><td>hm.baidu.com</td><td>63</td></tr><tr><td>mqqstr.beacon.qq.com</td><td>51</td></tr><tr><td>vortex.data.microsoft.com</td><td>51</td></tr><tr><td>mttstr.beacon.qq.com</td><td>48</td></tr><tr><td>sp0.baidu.com</td><td>44</td></tr><tr><td>wspeed.qq.com</td><td>41</td></tr><tr><td>adashbc.ut.taobao.com</td><td>41</td></tr><tr><td>dup.baidustatic.com</td><td>39</td></tr><tr><td>show-g.mediav.com</td><td>38</td></tr><tr><td>sp1.baidu.com</td><td>38</td></tr><tr><td>d.ifengimg.com</td><td>37</td></tr><tr><td>pingjs.qq.com</td><td>36</td></tr><tr><td>e.crashlytics.com</td><td>35</td></tr><tr><td>mobilelog.upqzfile.com</td><td>35</td></tr><tr><td>www.google-analytics.com</td><td>34</td></tr><tr><td>mtteve.beacon.qq.com</td><td>33</td></tr><tr><td>ulogs.umeng.com</td><td>33</td></tr><tr><td>ulogs.umengcloud.com</td><td>31</td></tr><tr><td>ios.bugly.qq.com</td><td>30</td></tr><tr><td>app-measurement.com</td><td>30</td></tr><tr><td>eclick.baidu.com</td><td>29</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Raspberry </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树莓派 </tag>
            
            <tag> AdGuard </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>为你的Valine添加评论邮箱提醒</title>
      <link href="2020/03/valine.html/"/>
      <url>2020/03/valine.html/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>作者在1.4.0+的版本中去除了邮件通知。过一段时间再看看commit修改下。<br>你现在可以使用1.3.10继续实现Valine的邮件通知或Valine-admin<a id="more"></a></p><h2 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h2><p>进入theme目录中你所使用的主题文件夹，这里以<code>hexo-Sakura</code>主题为例，编辑<code>layout/_partial/comments.ejs</code>。<br>在原有的<code>&lt;script&gt;</code>中添加以下代码</p><pre><code class="JavaScript">var notify = &#39;true&#39; ? true : false;var verify = &#39;false&#39; ? true : false;var GUEST_INFO = [&#39;nick&#39;,&#39;mail&#39;,&#39;link&#39;];var guest_info = &#39;nick,mail,link&#39;.split(&#39;,&#39;).filter(function(item){  return GUEST_INFO.indexOf(item) &gt; -1});</code></pre><p>在<code>valine.init</code>中添加</p><pre><code class="JavaScript">notify:notify</code></pre><p><img src="https://s1.ax1x.com/2020/03/15/83M3y4.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/03/15/83M3y4.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="添加"></p><h2 id="后台配置"><a href="#后台配置" class="headerlink" title="后台配置"></a>后台配置</h2><p>访问<a href="https://Leancloud.cn" target="_blank" rel="noopener">LeanCloud控制台</a><br>进入应用-设置-邮件模板<br>编辑<code>用于重置密码的邮件主题</code><br>这里提供一个内容模板，可以自行修改内容</p><pre><code class="HTML">&lt;p&gt;Hi, {{username}}&lt;/p&gt;&lt;p&gt;你在气象观测/萌新的BLOG的评论收到了新的回复，请点击查看：&lt;/p&gt;&lt;center&gt;&lt;a href=&quot;https://moex.club&quot; style=&quot;display: inline-block; padding: 10px 20px; border-radius: 4px; background-color: #3090e4; color: #fff; text-decoration: none;&quot;&gt;马上查看!&lt;/a&gt;&lt;/center&gt;</code></pre><p>收到回复的效果如下<br><img src="https://i.loli.net/2020/03/15/HXsR8t4gMEf9dPe.jpg" class="lazyload" data-srcset="https://i.loli.net/2020/03/15/HXsR8t4gMEf9dPe.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""><br>注：开启邮件回复提醒会valine自动开启评论验证码验证。</p><h3 id="Ad"><a href="#Ad" class="headerlink" title="Ad"></a>Ad</h3><p>气象观测站点上线啦！还不赶紧去看看<br><a href="https://moex.club" target="_blank" rel="noopener">点我直达</a></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Valine </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搭建蜜罐中央服务器MHN</title>
      <link href="2020/03/mhn.html/"/>
      <url>2020/03/mhn.html/</url>
      
        <content type="html"><![CDATA[<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>一台1核2G或以上的服务器<br>服务器系统为Ubuntu 14.04/16.04/12.02或Centos 6.9 。<a id="more"></a>以下操作我是在Ubuntu16.04 LTS服务器版本下进行的<br>如果为国内服务器请务必连接代理或更换软件源为腾讯云镜像源&amp;以下地址</p><pre><code>deb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial main restricteddeb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial-updates main restricteddeb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial universedeb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial main restricteddeb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial-updates main restricteddeb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial universedeb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial-updates universedeb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial multiversedeb http://us-east-2.ec2.archive.ubuntu.com/ubuntu/ xenial-updates multiverse</code></pre><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><pre><code class="BASH">cd /opt/sudo git clone https://github.com/threatstream/mhn.gitcd mhn/sudo ./install.sh</code></pre><p>若Github clone速度较慢可使用国内镜像仓库<code>https://git.code.tencent.com/MengXin/mhn.git</code><br>过程中请保证网络畅通，确保你当前网络环境可以访问上述源和Github，避免进行二次安装下载包错误。如果安装顺利3分钟左右就可以进入配置<br><img src="https://document-1254197101.cos.ap-guangzhou.myqcloud.com/hexo/pic/2-1024x594.png" class="lazyload" data-srcset="https://document-1254197101.cos.ap-guangzhou.myqcloud.com/hexo/pic/2-1024x594.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><h3 id="配置后台"><a href="#配置后台" class="headerlink" title="配置后台"></a>配置后台</h3><p>1.不运行debug<br>2.输要设置的后台管理的账号邮箱可以不填自己真实的<br>3.设置你的后台密码<br>4.重复密码<br>5.后台管理系统的地址，如果你的服务器开了80端口可以直接空格下一项<br>6.攻击地图的地址，请开启服务器的3000端口或者自行设置其他端口<br>7.邮件设置空格跳过<br>8.TLS和SSL都选n<br>9.不安装Splunk和ELK<br>安装完成后（设置完规则后）执行<code>supervisorctl status</code> 检查服务状态<br>不出意外的话mhn-celery-worker是启动失败的，执行<code>chmod 777 -R /var/log/mhn/mhn.log</code>后重新启动一遍服务<code>supervisorctl restart all</code>正确的情况是全部服务都在 RUNNING状态，此时访问服务器ip就可以进入后台管理页面。</p><h2 id="关于报错"><a href="#关于报错" class="headerlink" title="关于报错"></a>关于报错</h2><p>启动失败的服务除honeymap服务外都可以尝试用<code>supervisorctl start 服务名字</code><br>honeymap服务启动失败多半是因为网络原因，更换一个更好的梯子代理后重新尝试安装install.sh。<a href="https://blog.csdn.net/wutianxu123/article/details/84886811" target="_blank" rel="noopener">这里</a>给出了一个手动修复的教程，但我在尝试安装go的时候还是会被墙或者报错。</p><h2 id="原版配置"><a href="#原版配置" class="headerlink" title="原版配置"></a>原版配置</h2><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><ul><li>The MHN server is supported on Ubuntu 18.04, Ubuntu 16.04, and Centos 6.9.  </li><li>Other versions of Linux may work but are generally not tested or supported.</li></ul><p>Note: if you run into trouble during the install, please checkout the <a href="https://github.com/Pwnlandia/MHN/wiki/MHN-Troubleshooting-Guide" target="_blank" rel="noopener">troubleshooting guide</a> on the wiki.  If you only want to experiment with MHN on some virtual machines, please check out the <a href="https://github.com/Pwnlandia/mhn/wiki/Getting-up-and-running-using-Vagrant" target="_blank" rel="noopener">Getting up and Running with Vagrant</a> guide on the wiki.</p><p>Install Git</p><pre><code># on Debian or Ubuntu$ sudo apt install git -y</code></pre><p>Install MHN</p><pre><code>$ cd /opt/$ sudo git clone https://github.com/pwnlandia/mhn.git$ cd mhn/</code></pre><p>Run the following script to complete the installation.  While this script runs,<br>you will be prompted for some configuration options.  See below for how this<br>looks.</p><pre><code>$ sudo ./install.sh</code></pre><h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><pre><code>===========================================================MHN Configuration===========================================================Do you wish to run in Debug mode?: y/n nSuperuser email: YOUR_EMAIL@YOURSITE.COMSuperuser password: Server base url [&quot;http://1.2.3.4&quot;]: Honeymap url [&quot;http://1.2.3.4:3000&quot;]:Mail server address [&quot;localhost&quot;]: Mail server port [25]: Use TLS for email?: y/n nUse SSL for email?: y/n nMail server username [&quot;&quot;]: Mail server password [&quot;&quot;]: Mail default sender [&quot;&quot;]: Path for log file [&quot;mhn.log&quot;]: </code></pre><h3 id="Running"><a href="#Running" class="headerlink" title="Running"></a>Running</h3><p>If the installation scripts ran successfully, you should have a number of<br>services running on your MHN server.  See below for checking these.</p><pre><code>user@precise64:/opt/mhn/scripts$ sudo /etc/init.d/nginx status * nginx is runninguser@precise64:/opt/mhn/scripts$ sudo /etc/init.d/supervisor status is runninguser@precise64:/opt/mhn/scripts$ sudo supervisorctl statusgeoloc                           RUNNING    pid 31443, uptime 0:00:12honeymap                         RUNNING    pid 30826, uptime 0:08:54hpfeeds-broker                   RUNNING    pid 10089, uptime 0:36:42mhn-celery-beat                  RUNNING    pid 29909, uptime 0:18:41mhn-celery-worker                RUNNING    pid 29910, uptime 0:18:41mhn-collector                    RUNNING    pid 7872,  uptime 0:18:41mhn-uwsgi                        RUNNING    pid 29911, uptime 0:18:41mnemosyne                        RUNNING    pid 28173, uptime 0:30:08</code></pre><h3 id="Running-MHN-Behind-a-Proxy"><a href="#Running-MHN-Behind-a-Proxy" class="headerlink" title="Running MHN Behind a Proxy"></a>Running MHN Behind a Proxy</h3><p>For directions on running MHN behind a web proxy, follow the directions in the<br><a href="https://github.com/pwnlandia/mhn/wiki/Running-MHN-Behind-a-Web-Proxy" target="_blank" rel="noopener">wiki.</a></p><h3 id="Running-MHN-Over-HTTPS"><a href="#Running-MHN-Over-HTTPS" class="headerlink" title="Running MHN Over HTTPS"></a>Running MHN Over HTTPS</h3><p>By default MHN will run without HTTPS, to configure your installation to use SSL<br>certificates directions can be found in the <a href="https://github.com/pwnlandia/mhn/wiki/Running-MHN-Over-HTTPS" target="_blank" rel="noopener">wiki.</a></p><h3 id="Running-MHN-with-Docker"><a href="#Running-MHN-with-Docker" class="headerlink" title="Running MHN with Docker"></a>Running MHN with Docker</h3><p>Running MHN in docker is not officially supported, but it works.<br>The container takes a few minutes to start at the first launch to initialize.<br>Splunk, ArcSight and ELK are not yet supported in Docker.</p><h4 id="Build-it"><a href="#Build-it" class="headerlink" title="Build it"></a>Build it</h4><pre><code>$ docker build -t mhn .</code></pre><h4 id="Run-it"><a href="#Run-it" class="headerlink" title="Run it"></a>Run it</h4><pre><code>$ docker run -d -p 10000:10000 -p 80:80 -p 3000:3000 -p 8089:8089 \$ --restart unless-stopped \$ --name mhn \$ -e SUPERUSER_EMAIL=root@localhost \$ -e SUPERUSER_PASSWORD=password \$ -e SERVER_BASE_URL=&quot;http://mhn&quot; \$ -e HONEYMAP_URL=&quot;http://mhn:3000&quot; \$ mhn</code></pre><h4 id="Environment-variables"><a href="#Environment-variables" class="headerlink" title="Environment variables"></a>Environment variables</h4><pre><code>SUPERUSER_EMAILSUPERUSER_PASSWORDSERVER_BASE_URLHONEYMAP_URLDEBUG_MODESMTP_HOSTSMTP_PORTSMTP_TLSSMTP_SSLSMTP_USERNAMESMTP_PASSWORDSMTP_SENDERMHN_LOG</code></pre><h2 id="Deploying-honeypots-with-MHN"><a href="#Deploying-honeypots-with-MHN" class="headerlink" title="Deploying honeypots with MHN"></a>Deploying honeypots with MHN</h2><p>MHN was designed to make scalable deployment of honeypots easier.  Here are the<br>steps for deploying a honeypot with MHN:</p><ol><li>Login to your MHN server web app.</li><li>Click the “Deploy” link in the upper left hand corner.</li><li>Select a type of honeypot from the drop down menu (e.g. “Ubuntu Dionaea”).</li><li>Copy the deployment command.</li><li>Login to a honeypot server and run this command as root.</li></ol><p>If the deploy script successfully completes you should see the new sensor listed<br>under your deployed sensor list. For a full list of supported sensors, check the list here: <a href="https://github.com/pwnlandia/mhn/wiki/List-of-Supported-Sensors" target="_blank" rel="noopener">List of Supported Sensors</a></p><h2 id="Integration-with-Splunk-and-ArcSight"><a href="#Integration-with-Splunk-and-ArcSight" class="headerlink" title="Integration with Splunk and ArcSight"></a>Integration with Splunk and ArcSight</h2><p>hpfeeds-logger can be used to integrate MHN with Splunk and ArcSight.</p><h4 id="Splunk"><a href="#Splunk" class="headerlink" title="Splunk"></a>Splunk</h4><pre><code>cd /opt/mhn/scripts/sudo ./install_hpfeeds-logger-splunk.sh</code></pre><p>This will log the events as key/value pairs to /var/log/mhn-splunk.log.  This<br>log should be monitored by the SplunkUniversalForwarder.</p><h4 id="Arcsight"><a href="#Arcsight" class="headerlink" title="Arcsight"></a>Arcsight</h4><pre><code>cd /opt/mhn/scripts/sudo ./install_hpfeeds-logger-arcsight.sh</code></pre><p>This will log the events as CEF to /var/log/mhn-arcsight.log</p>]]></content>
      
      
      <categories>
          
          <category> Security </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MHN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Intel Xeon Gold 6278C参数</title>
      <link href="2020/02/6278c.html/"/>
      <url>2020/02/6278c.html/</url>
      
        <content type="html"><![CDATA[<p>在华为云S6云服务器上发现的，该型号牙膏厂官网没有相关信息，属于服务商定制CPU</p><a id="more"></a><pre><code> Name    Intel Xeon Gold Codename    Cascade Lake Specification    Intel(R) Xeon(R) Gold 6278C CPU @ 2.60GHz Package (platform ID)    Socket 3647 LGA (0x0) CPUID    6.5.7 Extended CPUID    6.55 Core Stepping     Technology    14 nm Core Speed    2600.0 MHz Stock frequency    2600 MHz Instructions sets    MMX, SSE, SSE2, SSE3, SSSE3, SSE4.1, SSE4.2, EM64T, AES, AVX, AVX2, AVX512F, FMA3, TSX Microcode Revision    0x1 L1 Data cache    32 KBytes, 8-way set associative, 64-byte line size L1 Instruction cache    32 KBytes, 8-way set associative, 64-byte line size L2 cache    1024 KBytes, 16-way set associative, 64-byte line size L3 cache    36608 KBytes, 11-way set associative, 64-byte line size Max CPUID level    0000000Dh Max CPUID ext. level    80000008h Cache descriptor    Level 1, D, 32 KB, 2 thread(s) Cache descriptor    Level 1, I, 32 KB, 2 thread(s) Cache descriptor    Level 2, U, 1 MB, 2 thread(s) Cache descriptor    Level 3, U, 36608 KB, 2 thread(s)</code></pre><p><img src="https://document-1254197101.cos.ap-guangzhou.myqcloud.com/hexo/pic/6278C.png" class="lazyload" data-srcset="https://document-1254197101.cos.ap-guangzhou.myqcloud.com/hexo/pic/6278C.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt=""></p><p>核心数/线程数/最大睿频未知<br>CPUZ基准Version17.01.64单核跑分349分</p>]]></content>
      
      
      <categories>
          
          <category> Intel </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xeon </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>食用软件无线电RTL-SDR</title>
      <link href="2020/01/rtl.html/"/>
      <url>2020/01/rtl.html/</url>
      
        <content type="html"><![CDATA[<h3 id="关于RTLSDR"><a href="#关于RTLSDR" class="headerlink" title="关于RTLSDR"></a>关于RTLSDR</h3><p>RTL-SDR这是一个低廉的家用消费档次的 DVB-T USB 接口的接收机的创新发明，一个完全的软件定义无线电。[^1]</p><a id="more"></a><p>也就是俗称的电视棒,可以用较低的价格来玩转软件无线电<br>本文所用到的是RTL2832U+R820T2</p><h3 id="食材"><a href="#食材" class="headerlink" title="食材"></a>食材</h3><ul><li>一根电视棒RTL2832U+R820T2（某宝上40左右即可买到）</li><li>一根天线，可以使用电视棒送的小天线</li><li>一台落灰的树莓派或电脑（本文两个环境会分别介绍）<h3 id="开始食用"><a href="#开始食用" class="headerlink" title="开始食用"></a>开始食用</h3><h4 id="树莓派搭建信号接受平台"><a href="#树莓派搭建信号接受平台" class="headerlink" title="树莓派搭建信号接受平台"></a>树莓派搭建信号接受平台</h4>系统为官方的Raspbian2018-1103<br>操作前建议先更换软件源，安利阿里云源</li></ul><pre><code class="bash">sudo apt-get updatesudo apt-get install cmake build-essential python-pip libusb-1.0-0-dev python-numpy git  # 安装依赖git clone git://git.osmocom.org/rtl-sdr.git   #开始安装rtl-sdrcd rtl-sdr/mkdir buildcd buildcmake ../ -DINSTALL_UDEV_RULES=ONmakesudo make installsudo ldconfig</code></pre><p>至此rtlsdr接受工作已经完成，接下来你可以食用freqshow直接在树莓派上显示，也可以通过rtl-tcp用windows下的sdrsharp软件来收听（windows和树莓派需位于同一局域网或树莓派所在网络开启了端口转发）。<br>在这里给出freqshow食用方法[^2]，但更推荐使用第二个操作</p><pre><code class="bash">sudo pip install pyrtlsdrcd ~git clone https://github.com/adafruit/FreqShow.gitcd FreqShow</code></pre><p>修改freqshow.py文件如下</p><pre><code class="bash"># Initialize pygame and SDL to use the PiTFT display and chscreen.#os.putenv(&#39;SDL_VIDEODRIVER&#39;, &#39;fbcon&#39;)#os.putenv(&#39;SDL_FBDEV&#39;      , &#39;/dev/fb1&#39;)#os.putenv(&#39;SDL_MOUSEDRV&#39;   , &#39;TSLIB&#39;)#os.putenv(&#39;SDL_MOUSEDEV&#39;   , &#39;/dev/input/touchscreen&#39;)pygame.mouse.set_visible(True)</code></pre><pre><code class="bash">sudo python freqshow.py#在freqshow目录里执行这个命令来启动freqshow</code></pre><p>使用tcp转发操作起来就比较容易<br>执行<code>rtl_tcp -a 你的树莓派内网ip</code><br>然后在windows上使用SDRSharp选择RTL_TCP，填入ip即可端口默认1234。</p><p>取消勾选RTLAGC<br>增益可自行拉下面的滑动条，取最合适的就可以。<a href="https://jq.qq.com/?_wv=1027&k=55b9O0W" target="_blank" rel="noopener">软件可以进大佬群自取</a></p><h4 id="Windows平台接受"><a href="#Windows平台接受" class="headerlink" title="Windows平台接受"></a>Windows平台接受</h4><p>依然要用到上面的软件（大佬群可以拿！）<br>先运行zadig进入Options选List All Devices就可以看到所有插在电脑上的rtl设备。选择rtl2832u点Reinstall Driver安装驱动。<br>运行#SDR选择RTL-USB/AM模式调节频率即可收听</p><h3 id="在树莓派上Dump1090"><a href="#在树莓派上Dump1090" class="headerlink" title="在树莓派上Dump1090"></a>在树莓派上Dump1090</h3><p>建议在pi的根目录执行</p><pre><code>git clone git://github.com/MalcolmRobb/dump1090.gitcd dump1090make</code></pre><p>安装完成后执行<code>./dump1090 -–interactive –-net</code>后在终端和访问树莓派的内网地址<code>ip:8080</code>即可显示上空飞机的信息</p><p>[^1]：来自百度百科<a href="https://baike.baidu.com/item/RTL-SDR/1338576" target="_blank" rel="noopener">https://baike.baidu.com/item/RTL-SDR/1338576</a><br>[^2]：freqshow安装过程参考<a href="https://learn.adafruit.com/freq-show-raspberry-pi-rtl-sdr-scanner/installation" target="_blank" rel="noopener">https://learn.adafruit.com/freq-show-raspberry-pi-rtl-sdr-scanner/installation</a></p>]]></content>
      
      
      <categories>
          
          <category> SDR </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RTL-SDR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>体验腾讯云万象优图</title>
      <link href="2019/12/detect.html/"/>
      <url>2019/12/detect.html/</url>
      
        <content type="html"><![CDATA[<p><a href="https://cloud.tencent.com/developer/labs/lab/10071" target="_blank" rel="noopener">原文</a>，本文只作笔记说明下部分地方自己使用时发现的问题，少量步骤省略。</p><h2 id="初始化配置"><a href="#初始化配置" class="headerlink" title="初始化配置"></a>初始化配置</h2><p>使用万象优图图片鉴黄 API 接口</p><a id="more"></a><p>获取腾讯云账号 APP ID<br>配置云 API 公钥/密钥<br>配置优图 bucket<br>首先在终端执行以下命令，创建目录 /data/try-pi，然后进入到该目录：</p><pre><code class="BASH">mkdir -p /data/try-pi &amp;&amp; cd $_</code></pre><p>然后在目录 /data/try-pi 下创建 init.sh 文件</p><pre><code class="BASH">#!/bin/bash########################################## 基础配置########################################## 腾讯云账号 APP ID# 在如下单引号内填入你的 APPIDexport APP_ID=&#39;&#39;# 云 API 公钥# 在如单引号内填入你的 SecretIDexport SECRET_ID=&#39;&#39;# 云 API 密钥# 在如下单引号内填入你的 SecretKeyexport SECRET_KEY=&#39;&#39;# 优图 bucket 名称# 如果你创建的 bucket 名称不叫 trial，替换为自己创建的即可export BUCKET_NAME=&#39;trial&#39;</code></pre><p>在云Api控制台中创建响应的ID和KEY</p><h2 id="将配置项导出为环境变量"><a href="#将配置项导出为环境变量" class="headerlink" title="将配置项导出为环境变量"></a>将配置项导出为环境变量</h2><p>在终端中执行以下命令，将各配置项导出为 Shell 环境变量：</p><pre><code class="BASH">source init.sh</code></pre><h2 id="生成鉴权签名"><a href="#生成鉴权签名" class="headerlink" title="生成鉴权签名"></a>生成鉴权签名</h2><p>将创建脚本来生成有效期为 30 天的多次有效的签名。在目录 /data/try-pi 下创建 gen-sign.sh 文件，然后在文件中贴入以下脚本：</p><pre><code class="BASH">#!/bin/bash########################################## 生成多次有效的鉴权签名（有效期 30 天） # @see https://cloud.tencent.com/document/product/460/6968########################################## 当前时间戳（秒）current_time=$(date +%s)# 到期时间戳（秒）expire_time=$(($current_time + 30 * 24 * 60 * 60))# 随机串，无符号 10 进制整数（不大于 10 位）rand=&#39;4815162342&#39;# 历史遗留字段，写死为 0user_id=&#39;0&#39;# 拼接签名串str=&quot;a=$APP_ID&amp;b=$BUCKET_NAME&amp;k=$SECRET_ID&amp;e=$expire_time&amp;t=$current_time&amp;r=$rand&amp;u=$user_id&quot;;# 使用 HMAC-SHA1 算法对签名串加密sign=$(echo -n $str | openssl dgst -sha1 -hmac $SECRET_KEY -binary)# 对加密串进行 Base64 编码sign=$(echo -n $sign$str | base64)# 移除多余的空格得到最终的鉴权签名sign=$(echo -n $sign | tr -d &#39; &#39;)# 导出鉴权签名export AUTH_SIGN=$sign</code></pre><h3 id="将签名导出为环境变量"><a href="#将签名导出为环境变量" class="headerlink" title="将签名导出为环境变量"></a>将签名导出为环境变量</h3><p>你应该在执行<code>source init.sh</code>后再执行该命令！</p><pre><code class="BASH">source gen-sign.sh</code></pre><h2 id="准备鉴黄脚本"><a href="#准备鉴黄脚本" class="headerlink" title="准备鉴黄脚本"></a>准备鉴黄脚本</h2><p>仍旧在目录 /data/try-pi 下创建 detect-porn.sh 文件，然后在文件中贴入以下脚本：</p><pre><code class="BASH">#!/bin/bash########################################## 鉴黄脚本# @see https://cloud.tencent.com/document/product/460/6900########################################## 图片鉴黄 API 地址END_POINT=&#39;https://service.image.myqcloud.com/detection/porn_detect&#39;# 使用帮助function usage() {  echo &quot;&quot;  echo &quot;-h --help&quot;  echo &quot;-r --remote-image=网络图片地址&quot;  echo &quot;-l --local-image=本地图片地址&quot;  echo &quot;&quot;}# 对网络图片进行鉴黄function detect_remote() {  remote_image=$1  curl -X POST \       -H &quot;Content-Type: application/json&quot; \       -H &quot;Authorization: $AUTH_SIGN&quot; \       -d &#39;{&quot;appid&quot;:&#39;$APP_ID&#39;,&quot;bucket&quot;:&quot;&#39;$BUCKET_NAME&#39;&quot;,&quot;url_list&quot;:[&quot;&#39;$remote_image&#39;&quot;]}&#39; \       --silent \       $END_POINT}# 对本地图片进行鉴黄function detect_local() {  local_image=$1  curl -X POST \       -H &quot;Content-Type: multipart/form-data&quot; \       -H &quot;Authorization: $AUTH_SIGN&quot; \       -F &quot;appid=$APP_ID&quot; \       -F &quot;bucket=$BUCKET_NAME&quot; \       -F &quot;image[0]=@$local_image&quot; \       --silent \       $END_POINT}# 解析命令入参while [ &quot;$1&quot; != &quot;&quot; ]; do  PARAM=`echo $1 | awk -F= &#39;{print $1}&#39;`  VALUE=`echo $1 | awk -F= &#39;{print $2}&#39;`  case $PARAM in    -h | --help)      usage      exit      ;;    -r | --remote-image)      detect_remote $VALUE      ;;    -l | --local-image)      detect_local $VALUE      ;;    *)      echo &quot;ERROR: 未知参数 \&quot;$PARAM\&quot;&quot;      exit 1      ;;  esac  shiftdone</code></pre><p>完成后测试该脚本是否可以正常运行<br><code>bash detect-porn.sh --remote-image=&#39;https://imgcache.qq.com/open_proj/proj_qcloud_v2/gateway/event/pc/ci-identify/css/img/demo/demo_8.jpg&#39;</code><br>如果出现Code：5可以再次先后执行<code>source init.sh</code>和<code>source gen-sign.sh</code>。<br>在每次重启设备后也要重新执行<code>source init.sh</code>和<code>source gen-sign.sh</code>。{测试于Raspbian树莓派}<br>2019最后一篇，再祝新年快乐！</p>]]></content>
      
      
      <categories>
          
          <category> Shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Note </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo站点部署教程</title>
      <link href="2019/12/build.html/"/>
      <url>2019/12/build.html/</url>
      
        <content type="html"><![CDATA[<h2 id="准备本地环境"><a href="#准备本地环境" class="headerlink" title="准备本地环境"></a>准备本地环境</h2><h3 id="Nodejs"><a href="#Nodejs" class="headerlink" title="Nodejs"></a>Nodejs</h3><p>在Node.js官网下载长期支持的Windows版本Node.js。</p><h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h3><p>在Git官网下载Windows版Git</p><a id="more"></a><h2 id="部署到Github-腾讯云COS"><a href="#部署到Github-腾讯云COS" class="headerlink" title="部署到Github/腾讯云COS"></a>部署到Github/腾讯云COS</h2><h3 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h3><p>登陆Github创建一个新的仓库，并命名为: <em>你的用户名.github.io</em><br><img src="https://cdn.jsdelivr.net/gh/MengXin001/CDN/pic/Repository%20name.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/MengXin001/CDN/pic/Repository%20name.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="仓库命名"><br>打开刚刚安装Git的目录，运行Git-bash。</p><pre><code class="BASH">输入 ssh-keygen -t rsa -C &quot;你的Github账号邮箱地址&quot;</code></pre><p>接下来一直回车，最后提示ssh密钥已经保存在C://Users/电脑用户名/.ssh目录下面。<br>打开.pub文件，复制内容到Github的用户-个人设置-SSH and GPG Keys-SSH keys里面。选择Add ssh key。</p><h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><p>在本地新建一个文件夹并将Sakura主题文件复制到这个文件夹内<br>进入命令行cd到新建文件夹</p><pre><code class="BASH">执行 npm install hexo-cli -g</code></pre><p>Hexo安装成功后安装npm的依赖。</p><pre><code class="BASH">npm install</code></pre><p>Hexo已经在本地安装完成，在命令行执行：</p><pre><code class="BASH">hexo s</code></pre><p>就可以在<a href="http://localhost中预览当前网页。" target="_blank" rel="noopener">http://localhost中预览当前网页。</a></p><h4 id="主题的基本设置"><a href="#主题的基本设置" class="headerlink" title="主题的基本设置"></a>主题的基本设置</h4><blockquote><p>博客根目录下的_config配置<br>以下引用自主题作者的Github说明文档，<a href="https://github.com/honjun/hexo-theme-sakura/blob/master/README-zh_cn.md" target="_blank" rel="noopener">原文</a></p></blockquote><p>站点</p><pre><code class="yml"># Sitetitle: 你的站点名subtitle:description: 站点简介keywords:author: 作者名language: zh-cntimezone:</code></pre><p>部署</p><pre><code class="yml">deploy:  type: git  repo:     github: 你的github仓库地址    # coding: 你的coding仓库地址  branch: master</code></pre><p>备份 （使用hexo b发布备份到远程仓库）</p><pre><code class="yml">backup:  type: git  message: backup my blog of https://honjun.github.io/  repository:    # 你的github仓库地址,备份分支名  （建议新建backup分支）    github: https://github.com/honjun/honjun.github.io.git,backup    # coding: https://git.coding.net/hojun/hojun.git,backup</code></pre><h4 id="主题目录下的-config配置"><a href="#主题目录下的-config配置" class="headerlink" title="主题目录下的_config配置"></a>主题目录下的_config配置</h4><p>其中标明【改】的是需要修改部门，标明【选】是可改可不改，标明【非】是不用改的部分</p><pre><code class="yml"># site name# 站点名 【改】prefixName: さくら荘そのsiteName: hojun# favicon and site master avatar# 站点的favicon和头像 输入图片路径（下面的配置是都是cdn的相对路径，没有cdn请填写完整路径，建议使用jsdeliver搭建一个cdn啦，先去下载我的cdn替换下图片就行了，简单方便~）【改】favicon: /images/favicon.icoavatar: /img/custom/avatar.jpg# 站点url 【改】url: https://sakura.hojun.cn# 站点介绍（或者说是个人签名）【改】description: Live your life with passion! With some drive!# 站点cdn，没有就为空 【改】  若是cdn为空，一些图片地址就要填完整地址了，比如之前avatar就要填https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/custom/avatar.jpgcdn: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6# 开启pjax 【选】pjax: 1# 站点首页的公告信息 【改】notice: hexo-Sakura主题已经开源，目前正在开发中...# 懒加载的加载中图片 【选】lazyloadImg: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg# 站点菜单配置 【选】menus:  首页: { path: /, fa: fa-fort-awesome faa-shake }  归档: { path: /archives, fa: fa-archive faa-shake, submenus: {     技术: {path: /categories/技术/, fa: fa-code },     生活: {path: /categories/生活/, fa: fa-file-text-o },     资源: {path: /categories/资源/, fa: fa-cloud-download },     随想: {path: /categories/随想/, fa: fa-commenting-o },    转载: {path: /categories/转载/, fa: fa-book }  } }  清单: { path: javascript:;, fa: fa-list-ul faa-vertical, submenus: {     书单: {path: /tags/悦读/, fa: fa-th-list faa-bounce },     番组: {path: /bangumi/, fa: fa-film faa-vertical },     歌单: {path: /music/, fa: fa-headphones },    图集: {path: /tags/图集/, fa: fa-photo }  } }  留言板: { path: /comment/, fa: fa-pencil-square-o faa-tada }  友人帐: { path: /links/, fa: fa-link faa-shake }  赞赏: { path: /donate/, fa: fa-heart faa-pulse }  关于: { path: /, fa: fa-leaf faa-wrench , submenus: {     我？: {path: /about/, fa: fa-meetup},     主题: {path: /theme-sakura/, fa: iconfont icon-sakura },    Lab: {path: /lab/, fa: fa-cogs },  } }  客户端: { path: /client/, fa: fa-android faa-vertical }  RSS: { path: /atom.xml, fa: fa-rss faa-pulse }# Home page sort type: -1: newer first，1: older first. 【非】homePageSortType: -1# Home page article shown number) 【非】homeArticleShown: 10# 背景图片 【选】bgn: 8# startdash面板 url, title, desc img 【改】startdash:   - {url: /theme-sakura/, title: Sakura, desc: 本站 hexo 主题, img: /img/startdash/sakura.md.png}  - {url: http://space.bilibili.com/271849279, title: Bilibili, desc: 博主的b站视频, img: /img/startdash/bilibili.jpg}  - {url: /, title: hojun的万事屋, desc: 技术服务, img: /img/startdash/wangshiwu.jpg}# your site build time or founded date# 你的站点建立日期 【改】siteBuildingTime: 07/17/2018# 社交按钮(social)  url, img PC端配置 【改】social:  github: {url: http://github.com/honjun, img: /img/social/github.png}  sina: {url: http://weibo.com/mashirozx?is_all=1, img: /img/social/sina.png}  wangyiyun: {url: http://weibo.com/mashirozx?is_all=1, img: /img/social/wangyiyun.png}  zhihu: {url: http://weibo.com/mashirozx?is_all=1, img: /img/social/zhihu.png}  email: {url: http://weibo.com/mashirozx?is_all=1, img: /img/social/email.svg}  wechat: {url: /#, qrcode: /img/custom/wechat.jpg, img: /img/social/wechat.png}# 社交按钮(msocial)  url, img 移动端配置 【改】msocial:  github: {url: http://github.com/honjun, fa: fa-github, color: 333}  weibo: {url: http://weibo.com/mashirozx?is_all=1, fa: fa-weibo, color: dd4b39}  qq: {url: https://wpa.qq.com/msgrd?v=3&amp;uin=954655431&amp;site=qq&amp;menu=yes, fa: fa-qq, color: 25c6fe}# 赞赏二维码（其中wechatSQ是赞赏单页面的赞赏码图片）【改】donate:  alipay: /img/custom/donate/AliPayQR.jpg  wechat: /img/custom/donate/WeChanQR.jpg  wechatSQ: /img/custom/donate/WeChanSQ.jpg# 首页视频地址为https://cdn.jsdelivr.net/gh/honjun/hojun@1.2/Unbroken.mp4，配置如下 【改】movies:  url: https://cdn.jsdelivr.net/gh/honjun/hojun@1.2  # 多个视频用逗号隔开，随机获取。支持的格式目前已知MP4,Flv。其他的可以试下，不保证有用  name: Unbroken.mp4# 左下角aplayer播放器配置 主要改id和server这两项，修改详见[aplayer文档] 【改】aplayer:   id: 2660651585  server: netease  type: playlist  fixed: true  mini: false  autoplay: false  loop: all  order: random  preload: auto  volume: 0.7  mutex: true# Valine评论配置【改】valine: truev_appId: GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHszv_appKey: mgOpfzbkHYqU92CV4IDlAUHQ</code></pre><h4 id="补充："><a href="#补充：" class="headerlink" title="补充："></a>补充：</h4><p>歌单页面设置</p><pre><code class="yml">---title: musicdate: 2018-12-20 23:14:28keywords: 喜欢的音乐description: comments: truephotos: 背景图地址---&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=100% height=450 src=&quot;//music.163.com/outchain/player?type=0&amp;id=网易云音乐歌单ID&amp;auto=1&amp;height=430&quot;&gt;&lt;/iframe&gt;</code></pre><h3 id="部署到Github"><a href="#部署到Github" class="headerlink" title="部署到Github"></a>部署到Github</h3><p>执行</p><pre><code class="BASH">hexo g //生成静态页hexo d //部署到仓库</code></pre><p>第一次推送会提示输入Github用户名和密码并配置相关信息<br>推送成功即显示<strong>Deploy done</strong></p><h3 id="绑定自己的域名"><a href="#绑定自己的域名" class="headerlink" title="绑定自己的域名"></a>绑定自己的域名</h3><p>现在你可以用xxx.github.io访问你的站点或者绑定自己的域名来访问<br>在source目录下新建一个文件（无后缀）:CNAME<br>用NotePad(能编辑这个文件的软件就可以)编辑内容为：你要绑定这个博客的域名。同时进入仓库-Settings拉到下面Custom Domain输入上边填写的域名。</p><h3 id="腾讯云部署和CDN使用"><a href="#腾讯云部署和CDN使用" class="headerlink" title="腾讯云部署和CDN使用"></a>腾讯云部署和CDN使用</h3><h4 id="COS"><a href="#COS" class="headerlink" title="COS"></a>COS</h4><p>腾讯云COS部署你可能需要一个备案的域名，其提供50G免费额度存储+10GCDN流量/月+100w次请求(免费额度请以官网为准)。<br>你可以使用npm安装hexo的cos部署插件或者直接上传本地生成的public文件夹内容到存储桶内。<br>腾讯云对象存储的地域对访问速度影响不大。我同时用了成都，广州和北京三个地区的存储(因为之前成都服务区开放可以再嫖到50G的免费存储），在不开CDN的情况下下载大文件可以达到13M/s。</p><h4 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h4><p>在Wordpress主站上用的是阿里云的全站内容动态加速，Hexo则用静态的CDN加速。这个站点用的是CloudFlare的CDN，对于国内访问延迟还是较大平均500ms但加载速度已经比GithubPage快很多了。用CF还是因为可以AntiDDoS，用Ali那是真的可以硬抗到流量用完。<br>你可以采用整站接入CDN，把绑定的域名绑定到CF上，再选择Proxy模式解析GithubPage。或者把页面里的图片/视频/Js;css等文件放到对象存储里，加载网页时从对象存储里获取。</p><h3 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h3><p>备份到远程仓库如腾讯云的工蜂Git(原代码托管?)，Github仓库，码云……</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
